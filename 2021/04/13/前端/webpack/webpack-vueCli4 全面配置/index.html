<!DOCTYPE html>

<html lang="zh-CN">

<head>
  
  <meta name="baidu-site-verification" content="code-J1Qg17G6wT" />
  <title>webpack-vueCli4全面配置 - 糖羽仙</title>
  <meta charset="UTF-8">
  <meta name="description" content="这是萌糖的官方网站">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
  
  

    <!-- Site Verification -->
    <meta name="baidu-site-verification" content="code-J1Qg17G6wT" />

  <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/tangyuxian/blog_image@master/head/head.jpg" type="image/png" />
  <meta name="description" content="细致全面的 vue-cli4 配置信息。涵盖了使用 vue-cli 开发过程中大部分配置需求。">
<meta property="og:type" content="article">
<meta property="og:title" content="webpack-vueCli4全面配置">
<meta property="og:url" content="https://www.tangyuxian.com/2021/04/13/%E5%89%8D%E7%AB%AF/webpack/webpack-vueCli4%20%E5%85%A8%E9%9D%A2%E9%85%8D%E7%BD%AE/index.html">
<meta property="og:site_name" content="糖羽仙">
<meta property="og:description" content="细致全面的 vue-cli4 配置信息。涵盖了使用 vue-cli 开发过程中大部分配置需求。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-04-13T03:51:10.000Z">
<meta property="article:modified_time" content="2021-07-24T17:28:06.482Z">
<meta property="article:author" content="tangyuxian">
<meta property="article:tag" content="转载">
<meta property="article:tag" content="vue">
<meta property="article:tag" content="工具">
<meta property="article:tag" content="webpack">
<meta name="twitter:card" content="summary">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/highlight.js@9.15.8/styles/atom-one-dark.css,gh/theme-nexmoe/hexo-theme-nexmoe@latest/source/lib/mdui_043tiny/css/mdui.css,gh/theme-nexmoe/hexo-theme-nexmoe@latest/source/lib/iconfont/iconfont.css,gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css?v=233" crossorigin>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css">
  
    <link rel="stylesheet" href="//at.alicdn.com/t/font_2421060_cksn56jaae6.css">
  
  <link rel="stylesheet" href="/css/style.css?v=1632320198519">
  <script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="mdui-drawer-body-left">
  
  <div id="nexmoe-background">
    <div class="nexmoe-bg" style="background-image: url(https://cdn.jsdelivr.net/gh/tangyuxian/blog_image@master/background/xiaomai.jpg)"></div>
    <div class="nexmoe-small" style="background-image: url(https://cdn.jsdelivr.net/gh/tangyuxian/blog_image@master/background/lihui.png)"></div>
    <div class="mdui-appbar mdui-shadow-0">
      <div class="mdui-toolbar">
        <a mdui-drawer="{target: '#drawer', swipe: true}" title="menu" class="mdui-btn mdui-btn-icon mdui-ripple"><i class="mdui-icon nexmoefont icon-menu"></i></a>
        <div class="mdui-toolbar-spacer"></div>
        <!--<a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
        <a href="/" title="tangyuxian" class="mdui-btn mdui-btn-icon"><img src="https://cdn.jsdelivr.net/gh/tangyuxian/blog_image@master/head/head.jpg" alt="tangyuxian"></a>
       </div>
    </div>
  </div>
  <div id="nexmoe-header">
      <div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="tangyuxian">
            <img src="https://cdn.jsdelivr.net/gh/tangyuxian/blog_image@master/head/head.jpg" alt="tangyuxian" alt="tangyuxian">
        </a>
    </div>
    <div class="nexmoe-count">
        <div class="nexmoe-count-item"><span>文章</span>54 <div class="item-radius"></div><div class="item-radius item-right"></div> </div>
        <div class="nexmoe-count-item"><span>标签</span>25<div class="item-radius"></div><div class="item-radius item-right"></div></div>
        <div class="nexmoe-count-item"><span>分类</span>4<div class="item-radius"></div><div class="item-radius item-right"></div></div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-meishi"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/archives.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-hanbao1"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/about.html" title="关于糖糖">
            <i class="mdui-list-item-icon nexmoefont icon-jiubei1"></i>
            <div class="mdui-list-item-content">
                关于糖糖
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple" href="/friend.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-cola"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
    </div>
    <aside id="nexmoe-sidebar">
  
  
<!-- 站内搜索 -->

<div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search" >
        <form id="search-form">
            <label><input type="text" id="local-search-input" name="q" results="0" placeholder="站内搜索" class="input form-control" autocomplete="off" autocorrect="off"/></label>
            <!-- 清空/重置搜索框 -->
            <i class="fa fa-times" onclick="resetSearch()"></i>
        </form>
    </div>
    <div id="local-search-result"></div> <!-- 搜索结果区 -->
    <!-- <p class='no-result'></p> 无匹配时显示，注意在 CSS 中设置默认隐藏 -->
</div>


  
  <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-social">
        <a class="mdui-ripple" href="http://wpa.qq.com/msgrd?v=3&uin=2120252100&site=qq&menu=yes" target="_blank" mdui-tooltip="{content: 'QQ'}" style="color: rgb(64, 196, 255);background-color: rgba(64, 196, 255, .1);">
            <i class="nexmoefont icon-QQ"></i>
        </a><a class="mdui-ripple" href="mailto:tangyuxian@vip.qq.com" target="_blank" mdui-tooltip="{content: 'mail'}" style="color: rgb(249,8,8);background-color: rgba(249,8,8,.1);">
            <i class="nexmoefont icon-mail-fill"></i>
        </a><a class="mdui-ripple" href="https://www.cnblogs.com/lovetangyuxian/" target="_blank" mdui-tooltip="{content: '博客园'}" style="color: rgb(66, 214, 29);background-color: rgba(66, 214, 29, .1);">
            <i class="nexmoefont icon-bokeyuan"></i>
        </a><a class="mdui-ripple" href="https://github.com/tangyuxian/" target="_blank" mdui-tooltip="{content: 'GitHub'}" style="color: rgb(25, 23, 23);background-color: rgba(25, 23, 23, .15);">
            <i class="nexmoefont icon-github"></i>
        </a><a class="mdui-ripple" href="https://gitee.com/tangyuxian" target="_blank" mdui-tooltip="{content: 'gitee'}" style="color: rgb(255, 255, 255);background-color: rgb(199,29,35);">
            <i class="nexmoefont icon-mayun"></i>
        </a>
    </div>
</div>
  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/前端/">前端</a>
          <span class="category-list-count">37</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/后端/">后端</a>
          <span class="category-list-count">7</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/开发工具/">开发工具</a>
          <span class="category-list-count">8</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/服务器端/">服务器端</a>
          <span class="category-list-count">1</span>
        </li>

        
      </ul>

    </div>
  </div>


  
  
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/JavaScript/" style="font-size: 16.25px;">JavaScript</a> <a href="/tags/Jetbrains/" style="font-size: 10px;">Jetbrains</a> <a href="/tags/centos/" style="font-size: 10px;">centos</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/es6/" style="font-size: 13.75px;">es6</a> <a href="/tags/git/" style="font-size: 13.75px;">git</a> <a href="/tags/http/" style="font-size: 11.25px;">http</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/markerdown/" style="font-size: 11.25px;">markerdown</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/node/" style="font-size: 11.25px;">node</a> <a href="/tags/vue/" style="font-size: 20px;">vue</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/%E4%BA%92%E8%81%94%E7%BD%91/" style="font-size: 10px;">互联网</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 12.5px;">加密</a> <a href="/tags/%E5%8E%9F%E5%88%9B/" style="font-size: 11.25px;">原创</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 13.75px;">工具</a> <a href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 12.5px;">微信小程序</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 10px;">数据结构</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 10px;">服务器</a> <a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" style="font-size: 17.5px;">浏览器</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 15px;">算法</a> <a href="/tags/%E7%BC%96%E8%A7%A3%E7%A0%81/" style="font-size: 10px;">编解码</a> <a href="/tags/%E8%BD%AC%E8%BD%BD/" style="font-size: 18.75px;">转载</a>
    </div>
    
  </div>

  
  
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/">2021</a><span class="archive-list-count">53</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


<style>
.nexmoe-widget .archive-list-count{
	position : absolute;
	right: 15px;
	top:9px;
	color: #DDD;
}
</style>

  
</aside>
    <div class="nexmoe-copyright">
        &copy; 2021 tangyuxian
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/tangyuxian/hexo-theme-tangyuxian" target="_blank">Tangyuxian</a><br/>
        <a href="http://beian.miit.gov.cn" target="_blank">辽ICP备2021002341号</a><br/>
        
        <div style="font-size: 12px">
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            本站总访问量  <a id="busuanzi_value_site_pv"></a> 次<br />
            本站访客数<a id="busuanzi_value_site_uv"></a>人次
        </div>
        
        
    </div>

</div><!-- .nexmoe-drawer -->

  </div>
  <div id="nexmoe-content">
    <div class="nexmoe-primary">
        <div class="nexmoe-post">
    
        <div class="nexmoe-post-cover" style="padding-bottom: 26.666666666666668%;">
            <img data-src="https://cdn.jsdelivr.net/gh/tangyuxian/blog_image@master/post/vue.jpg" data-sizes="auto" alt="webpack-vueCli4全面配置"
                 class="lazyload">
            <h1>webpack-vueCli4全面配置</h1>
        </div>
    

        <div class="nexmoe-post-meta nexmoe-rainbow" style="margin:10px 0!important;">
    <a><i class="nexmoefont icon-calendar-fill"></i>2021年04月13日</a>
    <a><i class="nexmoefont icon-areachart"></i>7.2k 字</a>
    <a><i class="nexmoefont icon-time-circle-fill"></i>大概 40 分钟</a>
</div>

        <div class="nexmoe-post-right">
            
        </div>

        <article>
            <p>细致全面的 vue-cli4 配置信息。涵盖了使用 vue-cli 开发过程中大部分配置需求。</p>
<span id="more"></span>

<h1 id="vue-cli4-全面配置"><a href="#vue-cli4-全面配置" class="headerlink" title="vue-cli4 全面配置"></a>vue-cli4 全面配置</h1><p><span id="top">目录</span></p>
<ul>
<li><a href="#env">√ 配置多环境变量</a></li>
<li><a href="#base">√ 配置基础 vue.config.js</a></li>
<li><a href="#proxy">√ 配置 proxy 跨域</a></li>
<li><a href="#hmr">√ 修复 HMR(热更新)失效</a></li>
<li><a href="#lazyloading">√ 修复 Lazy loading routes Error： Cyclic dependency</a></li>
<li><a href="#alias">√ 添加别名 alias</a></li>
<li><a href="#compressimage">√ 压缩图片</a></li>
<li><a href="#spritesmith">√ 自动生成雪碧图</a></li>
<li><a href="#font">√ SVG 转 font 字体</a></li>
<li><a href="#svg">√ 使用 SVG 组件</a></li>
<li><a href="#removecss">√ 去除多余无效的 css</a></li>
<li><a href="#analyze">√ 添加打包分析</a></li>
<li><a href="#externals">√ 配置 externals 引入 cdn 资源</a></li>
<li><a href="#multiple-pages">√ 多页面打包 multi-page</a></li>
<li><a href="#moment">√ 删除 moment 语言包</a></li>
<li><a href="#log">√ 去掉 console.log</a></li>
<li><a href="#splitchunks">√ 利用 splitChunks 单独打包第三方模块</a></li>
<li><a href="#gzip">√ 开启 gzip 压缩</a></li>
<li><a href="#stylelint">√ 开启 stylelint 检测scss, css语法</a></li>
<li><a href="#globalscss">√ 为 sass 提供全局样式，以及全局变量</a></li>
<li><a href="#globalstylus">√ 为 stylus 提供全局变量</a></li>
<li><a href="#prerender">√ 预渲染 prerender-spa-plugin</a></li>
<li><a href="#ie">√ 添加 IE 兼容</a></li>
<li><a href="#alioss">√ 静态资源自动打包上传阿里 oss、华为 obs</a></li>
<li><a href="#allconfig">√ 完整依赖</a></li>
</ul>
<h3 id="✅-配置多环境变量"><a href="#✅-配置多环境变量" class="headerlink" title="✅ 配置多环境变量"></a><span id="env">✅ 配置多环境变量</span></h3><p>&emsp;&emsp;通过在 package.json 里的 scripts 配置项中添加–mode xxx 来选择不同环境</p>
<p>&emsp;&emsp;只有以 VUE_APP 开头的变量会被 webpack.DefinePlugin 静态嵌入到客户端侧的包中，代码中可以通过 process.env.VUE_APP_BASE_API 访问</p>
<p>&emsp;&emsp;NODE_ENV 和 BASE_URL 是两个特殊变量，在代码中始终可用</p>
<h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><p>&emsp;&emsp;在项目根目录中新建.env, .env.production, .env.analyz 等文件</p>
<ul>
<li>.env</li>
</ul>
<p>&emsp;&emsp;serve 默认的本地开发环境配置</p>
<pre><code class="javascript">NODE_ENV = &quot;development&quot;
BASE_URL = &quot;./&quot;
VUE_APP_PUBLIC_PATH = &quot;./&quot;
VUE_APP_API = &quot;https://test.staven630.com/api&quot;
</code></pre>
<ul>
<li>.env.production</li>
</ul>
<p>&emsp;&emsp;build 默认的环境配置（正式服务器）</p>
<pre><code class="javascript">NODE_ENV = &quot;production&quot;
BASE_URL = &quot;https://prod.staven630.com/&quot;
VUE_APP_PUBLIC_PATH = &quot;https://prod.oss.com/staven-blog&quot;
VUE_APP_API = &quot;https://prod.staven630.com/api&quot;

ACCESS_KEY_ID = &quot;xxxxxxxxxxxxx&quot;
ACCESS_KEY_SECRET = &quot;xxxxxxxxxxxxx&quot;
REGION = &quot;oss-cn-hangzhou&quot;
BUCKET = &quot;staven-prod&quot;
PREFIX = &quot;staven-blog&quot;
</code></pre>
<ul>
<li>.env.crm</li>
</ul>
<p>&emsp;&emsp;自定义 build 环境配置（预发服务器）</p>
<pre><code class="javascript">NODE_ENV = &quot;production&quot;
BASE_URL = &quot;https://crm.staven630.com/&quot;
VUE_APP_PUBLIC_PATH = &quot;https://crm.oss.com/staven-blog&quot;
VUE_APP_API = &quot;https://crm.staven630.com/api&quot;

ACCESS_KEY_ID = &quot;xxxxxxxxxxxxx&quot;
ACCESS_KEY_SECRET = &quot;xxxxxxxxxxxxx&quot;
REGION = &quot;oss-cn-hangzhou&quot;
BUCKET = &quot;staven-crm&quot;
PREFIX = &quot;staven-blog&quot;

IS_ANALYZE = true;
</code></pre>
<p>&emsp;&emsp;修改 package.json</p>
<pre><code class="javascript">&quot;scripts&quot;: &#123;
  &quot;build&quot;: &quot;vue-cli-service build&quot;,
  &quot;crm&quot;: &quot;vue-cli-service build --mode crm&quot;
&#125;
</code></pre>
<h5 id="使用环境变量"><a href="#使用环境变量" class="headerlink" title="使用环境变量"></a>使用环境变量</h5><pre><code class="javascript">&lt;template&gt;
  &lt;div class=&quot;home&quot;&gt;
    &lt;!-- template中使用环境变量 --&gt;
     API: &#123;&#123; api &#125;&#125;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
export default &#123;
  name: &quot;home&quot;,
  data() &#123;
    return &#123;
      api: process.env.VUE_APP_API
    &#125;;
  &#125;,
  mounted() &#123;
    // js代码中使用环境变量
    console.log(&quot;BASE_URL: &quot;, process.env.BASE_URL);
    console.log(&quot;VUE_APP_API: &quot;, process.env.VUE_APP_API);
  &#125;
&#125;;
&lt;/script&gt;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-配置基础-vue-config-js"><a href="#✅-配置基础-vue-config-js" class="headerlink" title="✅ 配置基础 vue.config.js"></a><span id="base">✅ 配置基础 vue.config.js</span></h3><pre><code class="javascript">const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

module.exports = &#123;
  publicPath: IS_PROD ? process.env.VUE_APP_PUBLIC_PATH : &quot;./&quot;, // 默认&#39;/&#39;，部署应用包时的基本 URL
  // outputDir: process.env.outputDir || &#39;dist&#39;, // &#39;dist&#39;, 生产环境构建文件的目录
  // assetsDir: &quot;&quot;, // 相对于outputDir的静态资源(js、css、img、fonts)目录
  lintOnSave: false,
  runtimeCompiler: true, // 是否使用包含运行时编译器的 Vue 构建版本
  productionSourceMap: !IS_PROD, // 生产环境的 source map
  parallel: require(&quot;os&quot;).cpus().length &gt; 1,
  pwa: &#123;&#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-配置-proxy-代理解决跨域问题"><a href="#✅-配置-proxy-代理解决跨域问题" class="headerlink" title="✅ 配置 proxy 代理解决跨域问题"></a><span id="proxy">✅ 配置 proxy 代理解决跨域问题</span></h3><p>&emsp;&emsp;假设 mock 接口为<a target="_blank" rel="noopener" href="https://www.easy-mock.com/mock/5bc75b55dc36971c160cad1b/sheets/1">https://www.easy-mock.com/mock/5bc75b55dc36971c160cad1b/sheets/1</a></p>
<pre><code class="javascript">module.exports = &#123;
  devServer: &#123;
    // overlay: &#123; // 让浏览器 overlay 同时显示警告和错误
    //   warnings: true,
    //   errors: true
    // &#125;,
    // open: false, // 是否打开浏览器
    // host: &quot;localhost&quot;,
    // port: &quot;8080&quot;, // 代理断就
    // https: false,
    // hotOnly: false, // 热更新
    proxy: &#123;
      &quot;/api&quot;: &#123;
        target:
          &quot;https://www.easy-mock.com/mock/5bc75b55dc36971c160cad1b/sheets&quot;, // 目标代理接口地址
        secure: false,
        changeOrigin: true, // 开启代理，在本地创建一个虚拟服务端
        // ws: true, // 是否启用websockets
        pathRewrite: &#123;
          &quot;^/api&quot;: &quot;/&quot;
        &#125;
      &#125;
    &#125;
  &#125;
&#125;;
</code></pre>
<p>&emsp;&emsp;访问</p>
<pre><code class="javascript">&lt;script&gt;
import axios from &quot;axios&quot;;
export default &#123;
  mounted() &#123;
    axios.get(&quot;/api/1&quot;).then(res =&gt; &#123;
      console.log(&#39;proxy:&#39;, res);
    &#125;);
  &#125;
&#125;;
&lt;/script&gt;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-修复-HMR-热更新-失效"><a href="#✅-修复-HMR-热更新-失效" class="headerlink" title="✅ 修复 HMR(热更新)失效"></a><span id="hmr">✅ 修复 HMR(热更新)失效</span></h3><p>&emsp;&emsp;如果热更新失效，如下操作：</p>
<pre><code class="javascript">module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    // 修复HMR
    config.resolve.symlinks(true);
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-修复-Lazy-loading-routes-Error：-Cyclic-dependency-https-github-com-vuejs-vue-cli-issues-1669"><a href="#✅-修复-Lazy-loading-routes-Error：-Cyclic-dependency-https-github-com-vuejs-vue-cli-issues-1669" class="headerlink" title="✅ 修复 Lazy loading routes Error： Cyclic dependency https://github.com/vuejs/vue-cli/issues/1669"></a><span id="lazyloading">✅ 修复 Lazy loading routes Error： Cyclic dependency</span> <a target="_blank" rel="noopener" href="https://github.com/vuejs/vue-cli/issues/1669">https://github.com/vuejs/vue-cli/issues/1669</a></h3><pre><code class="javascript">module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    // 如果使用多页面打包，使用vue inspect --plugins查看html是否在结果数组中
    config.plugin(&quot;html&quot;).tap(args =&gt; &#123;
      // 修复 Lazy loading routes Error
      args[0].chunksSortMode = &quot;none&quot;;
      return args;
    &#125;);
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-添加别名-alias"><a href="#✅-添加别名-alias" class="headerlink" title="✅ 添加别名 alias"></a><span id="alias">✅ 添加别名 alias</span></h3><pre><code class="javascript">const path = require(&quot;path&quot;);
const resolve = dir =&gt; path.join(__dirname, dir);
const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    // 添加别名
    config.resolve.alias
      .set(&quot;vue$&quot;, &quot;vue/dist/vue.esm.js&quot;)
      .set(&quot;@&quot;, resolve(&quot;src&quot;))
      .set(&quot;@assets&quot;, resolve(&quot;src/assets&quot;))
      .set(&quot;@scss&quot;, resolve(&quot;src/assets/scss&quot;))
      .set(&quot;@components&quot;, resolve(&quot;src/components&quot;))
      .set(&quot;@plugins&quot;, resolve(&quot;src/plugins&quot;))
      .set(&quot;@views&quot;, resolve(&quot;src/views&quot;))
      .set(&quot;@router&quot;, resolve(&quot;src/router&quot;))
      .set(&quot;@store&quot;, resolve(&quot;src/store&quot;))
      .set(&quot;@layouts&quot;, resolve(&quot;src/layouts&quot;))
      .set(&quot;@static&quot;, resolve(&quot;src/static&quot;));
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-压缩图片"><a href="#✅-压缩图片" class="headerlink" title="✅ 压缩图片"></a><span id="compressimage">✅ 压缩图片</span></h3><pre><code class="javascript">npm i -D image-webpack-loader
</code></pre>
<p>&emsp;&emsp;在某些版本的 OSX 上安装可能会因缺少 libpng 依赖项而引发错误。可以通过安装最新版本的 libpng 来解决。</p>
<pre><code class="javascript">brew install libpng
</code></pre>
<pre><code class="javascript">module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    if (IS_PROD) &#123;
      config.module
        .rule(&quot;images&quot;)
        .use(&quot;image-webpack-loader&quot;)
        .loader(&quot;image-webpack-loader&quot;)
        .options(&#123;
          mozjpeg: &#123; progressive: true, quality: 65 &#125;,
          optipng: &#123; enabled: false &#125;,
          pngquant: &#123; quality: [0.65, 0.9], speed: 4 &#125;,
          gifsicle: &#123; interlaced: false &#125;
          // webp: &#123; quality: 75 &#125;
        &#125;);
    &#125;
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-自动生成雪碧图"><a href="#✅-自动生成雪碧图" class="headerlink" title="✅ 自动生成雪碧图"></a><span id="spritesmith">✅ 自动生成雪碧图</span></h3><p>&emsp;&emsp;默认 src/assets/icons 中存放需要生成雪碧图的 png 文件。首次运行 npm run serve/build 会生成雪碧图，并在跟目录生成 icons.json 文件。再次运行命令时，会对比 icons 目录内文件与 icons.json 的匹配关系，确定是否需要再次执行 webpack-spritesmith 插件。</p>
<pre><code class="bash">npm i -D webpack-spritesmith
</code></pre>
<pre><code class="javascript">let has_sprite = true;
let files = [];
const icons = &#123;&#125;;

try &#123;
  fs.statSync(resolve(&quot;./src/assets/icons&quot;));
  files = fs.readdirSync(resolve(&quot;./src/assets/icons&quot;));
  files.forEach(item =&gt; &#123;
    let filename = item.toLocaleLowerCase().replace(/_/g, &quot;-&quot;);
    icons[filename] = true;
  &#125;);

&#125; catch (error) &#123;
  fs.mkdirSync(resolve(&quot;./src/assets/icons&quot;));
&#125;

if (!files.length) &#123;
  has_sprite = false;
&#125; else &#123;
  try &#123;
    let iconsObj = fs.readFileSync(resolve(&quot;./icons.json&quot;), &quot;utf8&quot;);
    iconsObj = JSON.parse(iconsObj);
    has_sprite = files.some(item =&gt; &#123;
      let filename = item.toLocaleLowerCase().replace(/_/g, &quot;-&quot;);
      return !iconsObj[filename];
    &#125;);
    if (has_sprite) &#123;
      fs.writeFileSync(resolve(&quot;./icons.json&quot;), JSON.stringify(icons, null, 2));
    &#125;
  &#125; catch (error) &#123;
    fs.writeFileSync(resolve(&quot;./icons.json&quot;), JSON.stringify(icons, null, 2));
    has_sprite = true;
  &#125;
&#125;

// 雪碧图样式处理模板
const SpritesmithTemplate = function(data) &#123;
  // pc
  let icons = &#123;&#125;;
  let tpl = `.ico &#123; 
  display: inline-block; 
  background-image: url($&#123;data.sprites[0].image&#125;); 
  background-size: $&#123;data.spritesheet.width&#125;px $&#123;data.spritesheet.height&#125;px; 
&#125;`;

  data.sprites.forEach(sprite =&gt; &#123;
    const name = &quot;&quot; + sprite.name.toLocaleLowerCase().replace(/_/g, &quot;-&quot;);
    icons[`$&#123;name&#125;.png`] = true;
    tpl = `$&#123;tpl&#125; 
.ico-$&#123;name&#125;&#123;
  width: $&#123;sprite.width&#125;px; 
  height: $&#123;sprite.height&#125;px; 
  background-position: $&#123;sprite.offset_x&#125;px $&#123;sprite.offset_y&#125;px;
&#125;
`;
  &#125;);
  return tpl;
&#125;;

module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    const plugins = [];
    if (has_sprite) &#123;
      plugins.push(
        new SpritesmithPlugin(&#123;
          src: &#123;
            cwd: path.resolve(__dirname, &quot;./src/assets/icons/&quot;), // 图标根路径
            glob: &quot;**/*.png&quot; // 匹配任意 png 图标
          &#125;,
          target: &#123;
            image: path.resolve(__dirname, &quot;./src/assets/images/sprites.png&quot;), // 生成雪碧图目标路径与名称
            // 设置生成CSS背景及其定位的文件或方式
            css: [
              [
                path.resolve(__dirname, &quot;./src/assets/scss/sprites.scss&quot;),
                &#123;
                  format: &quot;function_based_template&quot;
                &#125;
              ]
            ]
          &#125;,
          customTemplates: &#123;
            function_based_template: SpritesmithTemplate
          &#125;,
          apiOptions: &#123;
            cssImageRef: &quot;../images/sprites.png&quot; // css文件中引用雪碧图的相对位置路径配置
          &#125;,
          spritesmithOptions: &#123;
            padding: 2
          &#125;
        &#125;)
      );
    &#125;

    config.plugins = [...config.plugins, ...plugins];
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-SVG-转-font-字体"><a href="#✅-SVG-转-font-字体" class="headerlink" title="✅ SVG 转 font 字体"></a><span id="font">✅ SVG 转 font 字体</span></h3><pre><code class="bash">npm i -D svgtofont
</code></pre>
<p>&emsp;&emsp;根目录新增 scripts 目录，并新建 svg2font.js 文件：</p>
<pre><code class="javascript">const svgtofont = require(&quot;svgtofont&quot;);
const path = require(&quot;path&quot;);
const pkg = require(&quot;../package.json&quot;);

svgtofont(&#123;
  src: path.resolve(process.cwd(), &quot;src/assets/svg&quot;), // svg 图标目录路径
  dist: path.resolve(process.cwd(), &quot;src/assets/fonts&quot;), // 输出到指定目录中
  fontName: &quot;icon&quot;, // 设置字体名称
  css: true, // 生成字体文件
  startNumber: 20000, // unicode起始编号
  svgicons2svgfont: &#123;
    fontHeight: 1000,
    normalize: true
  &#125;,
  // website = null, 没有演示html文件
  website: &#123;
    title: &quot;icon&quot;,
    logo: &quot;&quot;,
    version: pkg.version,
    meta: &#123;
      description: &quot;&quot;,
      keywords: &quot;&quot;
    &#125;,
    description: ``,
    links: [
      &#123;
        title: &quot;Font Class&quot;,
        url: &quot;index.html&quot;
      &#125;,
      &#123;
        title: &quot;Unicode&quot;,
        url: &quot;unicode.html&quot;
      &#125;
    ],
    footerInfo: ``
  &#125;
&#125;).then(() =&gt; &#123;
  console.log(&quot;done!&quot;);
&#125;);
</code></pre>
<p>&emsp;&emsp;添加 package.json scripts 配置：</p>
<pre><code class="javascript">&quot;prebuild&quot;: &quot;npm run font&quot;,
&quot;font&quot;: &quot;node scripts/svg2font.js&quot;,
</code></pre>
<p>&emsp;&emsp;执行：</p>
<pre><code class="javascript">npm run font
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-使用-SVG-组件"><a href="#✅-使用-SVG-组件" class="headerlink" title="✅ 使用 SVG 组件"></a><span id="svg">✅ 使用 SVG 组件</span></h3><pre><code class="bash">npm i -D svg-sprite-loader
</code></pre>
<p>&emsp;&emsp;新增 SvgIcon 组件。</p>
<pre><code class="javascript">&lt;template&gt;
  &lt;svg class=&quot;svg-icon&quot;
       aria-hidden=&quot;true&quot;&gt;
    &lt;use :xlink:href=&quot;iconName&quot; /&gt;
  &lt;/svg&gt;
&lt;/template&gt;

&lt;script&gt;
export default &#123;
  name: &#39;SvgIcon&#39;,
  props: &#123;
    iconClass: &#123;
      type: String,
      required: true
    &#125;
  &#125;,
  computed: &#123;
    iconName() &#123;
      return `#icon-$&#123;this.iconClass&#125;`
    &#125;
  &#125;
&#125;
&lt;/script&gt;

&lt;style scoped&gt;
.svg-icon &#123;
  width: 1em;
  height: 1em;
  vertical-align: -0.15em;
  fill: currentColor;
  overflow: hidden;
&#125;
&lt;/style&gt;
</code></pre>
<p>&emsp;&emsp;在 src 文件夹中创建 icons 文件夹。icons 文件夹中新增 svg 文件夹（用来存放 svg 文件）与 index.js 文件：</p>
<pre><code class="js">import SvgIcon from &quot;@/components/SvgIcon&quot;;
import Vue from &quot;vue&quot;;

// 注册到全局
Vue.component(&quot;svg-icon&quot;, SvgIcon);

const requireAll = requireContext =&gt; requireContext.keys().map(requireContext);
const req = require.context(&quot;./svg&quot;, false, /\.svg$/);
requireAll(req);
</code></pre>
<p>&emsp;&emsp;在 main.js 中导入 icons/index.js</p>
<pre><code class="javascript">import &quot;@/icons&quot;;
</code></pre>
<p>&emsp;&emsp;修改 vue.config.js</p>
<pre><code class="javascript">const path = require(&quot;path&quot;);
const resolve = dir =&gt; path.join(__dirname, dir);

module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    const svgRule = config.module.rule(&quot;svg&quot;);
    svgRule.uses.clear();
    svgRule.exclude.add(/node_modules/);
    svgRule
      .test(/\.svg$/)
      .use(&quot;svg-sprite-loader&quot;)
      .loader(&quot;svg-sprite-loader&quot;)
      .options(&#123;
        symbolId: &quot;icon-[name]&quot;
      &#125;);

    const imagesRule = config.module.rule(&quot;images&quot;);
    imagesRule.exclude.add(resolve(&quot;src/icons&quot;));
    config.module.rule(&quot;images&quot;).test(/\.(png|jpe?g|gif|svg)(\?.*)?$/);
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-去除多余无效的-css"><a href="#✅-去除多余无效的-css" class="headerlink" title="✅ 去除多余无效的 css"></a><span id="removecss">✅ 去除多余无效的 css</span></h3><p>&emsp;&emsp;注：谨慎使用。可能出现各种样式丢失现象。</p>
<ul>
<li>方案一：@fullhuman/postcss-purgecss</li>
</ul>
<pre><code class="bash">npm i -D postcss-import @fullhuman/postcss-purgecss
</code></pre>
<p>&emsp;&emsp;更新 postcss.config.js</p>
<pre><code class="javascript">const autoprefixer = require(&quot;autoprefixer&quot;);
const postcssImport = require(&quot;postcss-import&quot;);
const purgecss = require(&quot;@fullhuman/postcss-purgecss&quot;);
const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);
let plugins = [];
if (IS_PROD) &#123;
  plugins.push(postcssImport);
  plugins.push(
    purgecss(&#123;
      content: [
        &quot;./layouts/**/*.vue&quot;,
        &quot;./components/**/*.vue&quot;,
        &quot;./pages/**/*.vue&quot;
      ],
      extractors: [
        &#123;
          extractor: class Extractor &#123;
            static extract(content) &#123;
              const validSection = content.replace(
                /&lt;style([\s\S]*?)&lt;\/style&gt;+/gim,
                &quot;&quot;
              );
              return (
                validSection.match(/[A-Za-z0-9-_/:]*[A-Za-z0-9-_/]+/g) || []
              );
            &#125;
          &#125;,
          extensions: [&quot;html&quot;, &quot;vue&quot;]
        &#125;
      ],
      whitelist: [&quot;html&quot;, &quot;body&quot;],
      whitelistPatterns: [
        /el-.*/,
        /-(leave|enter|appear)(|-(to|from|active))$/,
        /^(?!cursor-move).+-move$/,
        /^router-link(|-exact)-active$/
      ],
      whitelistPatternsChildren: [/^token/, /^pre/, /^code/]
    &#125;)
  );
&#125;
module.exports = &#123;
  plugins: [...plugins, autoprefixer]
&#125;;
</code></pre>
<ul>
<li>方案二：purgecss-webpack-plugin</li>
</ul>
<pre><code class="bash">npm i -D glob-all purgecss-webpack-plugin
</code></pre>
<pre><code class="javascript">const path = require(&quot;path&quot;);
const glob = require(&quot;glob-all&quot;);
const PurgecssPlugin = require(&quot;purgecss-webpack-plugin&quot;);
const resolve = dir =&gt; path.join(__dirname, dir);
const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    const plugins = [];
    if (IS_PROD) &#123;
      plugins.push(
        new PurgecssPlugin(&#123;
          paths: glob.sync([resolve(&quot;./**/*.vue&quot;)]),
          extractors: [
            &#123;
              extractor: class Extractor &#123;
                static extract(content) &#123;
                  const validSection = content.replace(
                    /&lt;style([\s\S]*?)&lt;\/style&gt;+/gim,
                    &quot;&quot;
                  );
                  return (
                    validSection.match(/[A-Za-z0-9-_/:]*[A-Za-z0-9-_/]+/g) || []
                  );
                &#125;
              &#125;,
              extensions: [&quot;html&quot;, &quot;vue&quot;]
            &#125;
          ],
          whitelist: [&quot;html&quot;, &quot;body&quot;],
          whitelistPatterns: [
            /el-.*/,
            /-(leave|enter|appear)(|-(to|from|active))$/,
            /^(?!cursor-move).+-move$/,
            /^router-link(|-exact)-active$/
          ],
          whitelistPatternsChildren: [/^token/, /^pre/, /^code/]
        &#125;)
      );
    &#125;
    config.plugins = [...config.plugins, ...plugins];
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-添加打包分析"><a href="#✅-添加打包分析" class="headerlink" title="✅ 添加打包分析"></a><span id="analyze">✅ 添加打包分析</span></h3><pre><code class="javascript">const BundleAnalyzerPlugin = require(&quot;webpack-bundle-analyzer&quot;)
  .BundleAnalyzerPlugin;

module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    // 打包分析
    if (IS_PROD) &#123;
      config.plugin(&quot;webpack-report&quot;).use(BundleAnalyzerPlugin, [
        &#123;
          analyzerMode: &quot;static&quot;
        &#125;
      ]);
    &#125;
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-配置-externals-引入-cdn-资源"><a href="#✅-配置-externals-引入-cdn-资源" class="headerlink" title="✅ 配置 externals 引入 cdn 资源"></a><span id="externals">✅ 配置 externals 引入 cdn 资源</span></h3><p>&emsp;&emsp;防止将某些 import 的包(package)打包到 bundle 中，而是在运行时(runtime)再去从外部获取这些扩展依赖</p>
<pre><code class="javascript">module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    config.externals = &#123;
      vue: &quot;Vue&quot;,
      &quot;element-ui&quot;: &quot;ELEMENT&quot;,
      &quot;vue-router&quot;: &quot;VueRouter&quot;,
      vuex: &quot;Vuex&quot;,
      axios: &quot;axios&quot;
    &#125;;
  &#125;,
  chainWebpack: config =&gt; &#123;
    const cdn = &#123;
      // 访问https://unpkg.com/element-ui/lib/theme-chalk/index.css获取最新版本
      css: [&quot;//unpkg.com/element-ui@2.10.1/lib/theme-chalk/index.css&quot;],
      js: [
        &quot;//unpkg.com/vue@2.6.10/dist/vue.min.js&quot;, // 访问https://unpkg.com/vue/dist/vue.min.js获取最新版本
        &quot;//unpkg.com/vue-router@3.0.6/dist/vue-router.min.js&quot;,
        &quot;//unpkg.com/vuex@3.1.1/dist/vuex.min.js&quot;,
        &quot;//unpkg.com/axios@0.19.0/dist/axios.min.js&quot;,
        &quot;//unpkg.com/element-ui@2.10.1/lib/index.js&quot;
      ]
    &#125;;

    // 如果使用多页面打包，使用vue inspect --plugins查看html是否在结果数组中
    config.plugin(&quot;html&quot;).tap(args =&gt; &#123;
      // html中添加cdn
      args[0].cdn = cdn;
      return args;
    &#125;);
  &#125;
&#125;;
</code></pre>
<p>&emsp;&emsp;在 html 中添加</p>
<pre><code>&lt;!-- 使用CDN的CSS文件 --&gt;
&lt;% for (var i in htmlWebpackPlugin.options.cdn &amp;&amp;
htmlWebpackPlugin.options.cdn.css) &#123; %&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;&lt;%= htmlWebpackPlugin.options.cdn.css[i] %&gt;&quot; /&gt;
&lt;% &#125; %&gt;

&lt;!-- 使用CDN的JS文件 --&gt;
&lt;% for (var i in htmlWebpackPlugin.options.cdn &amp;&amp;
htmlWebpackPlugin.options.cdn.js) &#123; %&gt;
&lt;script
  type=&quot;text/javascript&quot;
  src=&quot;&lt;%= htmlWebpackPlugin.options.cdn.js[i] %&gt;&quot;
&gt;&lt;/script&gt;
&lt;% &#125; %&gt;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-多页面打包-multi-page"><a href="#✅-多页面打包-multi-page" class="headerlink" title="✅ 多页面打包 multi-page"></a><span id="multiple-pages">✅ 多页面打包 multi-page</span></h3><p>&emsp;&emsp;多入口页面打包，建议在 src 目录下新建 pages 目录存放多页面模块。</p>
<ul>
<li>pages.config.js</li>
</ul>
<p>&emsp;&emsp; 配置多页面信息。src/main.js 文件对应 main 字段，其他根据参照 pages 为根路径为字段。如下:</p>
<pre><code class="javascript">module.exports = &#123;
  &#39;admin&#39;: &#123;
    template: &#39;public/index.html&#39;,
    filename: &#39;admin.html&#39;,
    title: &#39;后台管理&#39;,
  &#125;,
  &#39;mobile&#39;: &#123;
    template: &#39;public/index.html&#39;,
    filename: &#39;mobile.html&#39;,
    title: &#39;移动端&#39;,
  &#125;,
  &#39;pc/crm&#39;: &#123;
    template: &#39;public/index.html&#39;,
    filename: &#39;pc-crm.html&#39;,
    title: &#39;预发服务&#39;,
  &#125;
&#125;
</code></pre>
<ul>
<li>vue.config.js</li>
</ul>
<p>&emsp;&emsp;vue.config.js 的 pages 字段为多页面提供配置</p>
<pre><code class="javascript">const glob = require(&quot;glob&quot;);
const pagesInfo = require(&quot;./pages.config&quot;);
const pages = &#123;&#125;;

glob.sync(&#39;./src/pages/**/main.js&#39;).forEach(entry =&gt; &#123;
  let chunk = entry.match(/\.\/src\/pages\/(.*)\/main\.js/)[1];
  const curr = pagesInfo[chunk];
  if (curr) &#123;
    pages[chunk] = &#123;
      entry,
      ...curr,
      chunk: [&quot;chunk-vendors&quot;, &quot;chunk-common&quot;, chunk]
    &#125;
  &#125;
&#125;)

module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    // 防止多页面打包卡顿
    config =&gt; config.plugins.delete(&quot;named-chunks&quot;);

    return config;
  &#125;,
  pages
&#125;;
</code></pre>
<p>&emsp;&emsp;如果多页面打包需要使用 CDN，使用 vue inspect –plugins 查看 html 是否在结果数组中的形式。上例中 plugins 列表中存在’html-main’,’html-pages/admin’,’html-pages/mobile’， 没有’html’。因此不能再使用 config.plugin(“html”)。</p>
<pre><code class="javascript">const path = require(&quot;path&quot;);
const resolve = dir =&gt; path.join(__dirname, dir);
const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

const glob = require(&quot;glob&quot;);
const pagesInfo = require(&quot;./pages.config&quot;);
const pages = &#123;&#125;;

glob.sync(&#39;./src/pages/**/main.js&#39;).forEach(entry =&gt; &#123;
  let chunk = entry.match(/\.\/src\/pages\/(.*)\/main\.js/)[1];
  const curr = pagesInfo[chunk];
  if (curr) &#123;
    pages[chunk] = &#123;
      entry,
      ...curr,
      chunk: [&quot;chunk-vendors&quot;, &quot;chunk-common&quot;, chunk]
    &#125;
  &#125;
&#125;);

module.exports = &#123;
  publicPath: IS_PROD ? process.env.VUE_APP_PUBLIC_PATH : &quot;./&quot;, //
  configureWebpack: config =&gt; &#123;
    config.externals = &#123;
      vue: &quot;Vue&quot;,
      &quot;element-ui&quot;: &quot;ELEMENT&quot;,
      &quot;vue-router&quot;: &quot;VueRouter&quot;,
      vuex: &quot;Vuex&quot;,
      axios: &quot;axios&quot;
    &#125;;
  &#125;,
  chainWebpack: config =&gt; &#123;
    const cdn = &#123;
      // 访问https://unpkg.com/element-ui/lib/theme-chalk/index.css获取最新版本
      css: [&quot;//unpkg.com/element-ui@2.10.1/lib/theme-chalk/index.css&quot;],
      js: [
        &quot;//unpkg.com/vue@2.6.10/dist/vue.min.js&quot;, // 访问https://unpkg.com/vue/dist/vue.min.js获取最新版本
        &quot;//unpkg.com/vue-router@3.0.6/dist/vue-router.min.js&quot;,
        &quot;//unpkg.com/vuex@3.1.1/dist/vuex.min.js&quot;,
        &quot;//unpkg.com/axios@0.19.0/dist/axios.min.js&quot;,
        &quot;//unpkg.com/element-ui@2.10.1/lib/index.js&quot;
      ]
    &#125;;

    // 防止多页面打包卡顿
    config =&gt; config.plugins.delete(&quot;named-chunks&quot;);

    // 多页面cdn添加
    Object.keys(pagesInfo).forEach(page =&gt; &#123;
      config.plugin(`html-$&#123;page&#125;`).tap(args =&gt; &#123;
        // html中添加cdn
        args[0].cdn = cdn;

        // 修复 Lazy loading routes Error
        args[0].chunksSortMode = &quot;none&quot;;
        return args;
      &#125;);
    &#125;);
    return config;
  &#125;,
  pages
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-删除-moment-语言包"><a href="#✅-删除-moment-语言包" class="headerlink" title="✅ 删除 moment 语言包"></a><span id="moment">✅ 删除 moment 语言包</span></h3><p>&emsp;&emsp;删除 moment 除 zh-cn 中文包外的其它语言包，无需在代码中手动引入 zh-cn 语言包。</p>
<pre><code class="javascript">const webpack = require(&quot;webpack&quot;);

module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    config
      .plugin(&quot;ignore&quot;)
      .use(
        new webpack.ContextReplacementPlugin(/moment[/\\]locale$/, /zh-cn$/)
      );

    return config;
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-去掉-console-log"><a href="#✅-去掉-console-log" class="headerlink" title="✅ 去掉 console.log"></a><span id="log">✅ 去掉 console.log</span></h3><h5 id="方法一：使用-babel-plugin-transform-remove-console-插件"><a href="#方法一：使用-babel-plugin-transform-remove-console-插件" class="headerlink" title="方法一：使用 babel-plugin-transform-remove-console 插件"></a>方法一：使用 babel-plugin-transform-remove-console 插件</h5><pre><code class="bash">npm i -D babel-plugin-transform-remove-console
</code></pre>
<p>在 babel.config.js 中配置</p>
<pre><code>const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

const plugins = [];
if (IS_PROD) &#123;
  plugins.push(&quot;transform-remove-console&quot;);
&#125;

module.exports = &#123;
  presets: [&quot;@vue/app&quot;, &#123; useBuiltIns: &quot;entry&quot; &#125;],
  plugins
&#125;;
</code></pre>
<h5 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h5><pre><code class="javascript">const UglifyJsPlugin = require(&quot;uglifyjs-webpack-plugin&quot;);
module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    if (IS_PROD) &#123;
      const plugins = [];
      plugins.push(
        new UglifyJsPlugin(&#123;
          uglifyOptions: &#123;
            compress: &#123;
              warnings: false,
              drop_console: true,
              drop_debugger: false,
              pure_funcs: [&quot;console.log&quot;] //移除console
            &#125;
          &#125;,
          sourceMap: false,
          parallel: true
        &#125;)
      );
      config.plugins = [...config.plugins, ...plugins];
    &#125;
  &#125;
&#125;;
</code></pre>
<p>&emsp;&emsp;如果使用 uglifyjs-webpack-plugin 会报错，可能存在 node_modules 中有些依赖需要 babel 转译。</p>
<p>&emsp;&emsp;而 vue-cli 的<a target="_blank" rel="noopener" href="https://cli.vuejs.org/zh/config/#transpiledependencies">transpileDependencies</a>配置默认为[], babel-loader 会忽略所有 node_modules 中的文件。如果你想要通过 Babel 显式转译一个依赖，可以在这个选项中列出来。配置需要转译的第三方库。</p>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="利用-splitChunks-单独打包第三方模块"><a href="#利用-splitChunks-单独打包第三方模块" class="headerlink" title="利用 splitChunks 单独打包第三方模块"></a><span id="splitchunks">利用 splitChunks 单独打包第三方模块</span></h3><pre><code class="javascript">const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    if (IS_PROD) &#123;
      config.optimization = &#123;
        splitChunks: &#123;
          cacheGroups: &#123;
            common: &#123;
              name: &quot;chunk-common&quot;,
              chunks: &quot;initial&quot;,
              minChunks: 2,
              maxInitialRequests: 5,
              minSize: 0,
              priority: 1,
              reuseExistingChunk: true,
              enforce: true
            &#125;,
            vendors: &#123;
              name: &quot;chunk-vendors&quot;,
              test: /[\\/]node_modules[\\/]/,
              chunks: &quot;initial&quot;,
              priority: 2,
              reuseExistingChunk: true,
              enforce: true
            &#125;,
            elementUI: &#123;
              name: &quot;chunk-elementui&quot;,
              test: /[\\/]node_modules[\\/]element-ui[\\/]/,
              chunks: &quot;all&quot;,
              priority: 3,
              reuseExistingChunk: true,
              enforce: true
            &#125;,
            echarts: &#123;
              name: &quot;chunk-echarts&quot;,
              test: /[\\/]node_modules[\\/](vue-)?echarts[\\/]/,
              chunks: &quot;all&quot;,
              priority: 4,
              reuseExistingChunk: true,
              enforce: true
            &#125;
          &#125;
        &#125;
      &#125;;
    &#125;
  &#125;,
  chainWebpack: config =&gt; &#123;
    if (IS_PROD) &#123;
      config.optimization.delete(&quot;splitChunks&quot;);
    &#125;
    return config;
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-开启-gzip-压缩"><a href="#✅-开启-gzip-压缩" class="headerlink" title="✅ 开启 gzip 压缩"></a><span id="gzip">✅ 开启 gzip 压缩</span></h3><pre><code class="bash">npm i -D compression-webpack-plugin
</code></pre>
<pre><code class="javascript">const CompressionWebpackPlugin = require(&quot;compression-webpack-plugin&quot;);

const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);
const productionGzipExtensions = /\.(js|css|json|txt|html|ico|svg)(\?.*)?$/i;

module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    const plugins = [];
    if (IS_PROD) &#123;
      plugins.push(
        new CompressionWebpackPlugin(&#123;
          filename: &quot;[path].gz[query]&quot;,
          algorithm: &quot;gzip&quot;,
          test: productionGzipExtensions,
          threshold: 10240,
          minRatio: 0.8
        &#125;)
      );
    &#125;
    config.plugins = [...config.plugins, ...plugins];
  &#125;
&#125;;
</code></pre>
<p>&emsp;&emsp;还可以开启比 gzip 体验更好的 Zopfli 压缩详见<a target="_blank" rel="noopener" href="https://webpack.js.org/plugins/compression-webpack-plugin">https://webpack.js.org/plugins/compression-webpack-plugin</a></p>
<pre><code class="bash">npm i -D @gfx/zopfli brotli-webpack-plugin
</code></pre>
<pre><code class="javascript">const CompressionWebpackPlugin = require(&quot;compression-webpack-plugin&quot;);
const zopfli = require(&quot;@gfx/zopfli&quot;);
const BrotliPlugin = require(&quot;brotli-webpack-plugin&quot;);

const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);
const productionGzipExtensions = /\.(js|css|json|txt|html|ico|svg)(\?.*)?$/i;

module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    const plugins = [];
    if (IS_PROD) &#123;
      plugins.push(
        new CompressionWebpackPlugin(&#123;
          algorithm(input, compressionOptions, callback) &#123;
            return zopfli.gzip(input, compressionOptions, callback);
          &#125;,
          compressionOptions: &#123;
            numiterations: 15
          &#125;,
          minRatio: 0.99,
          test: productionGzipExtensions
        &#125;)
      );
      plugins.push(
        new BrotliPlugin(&#123;
          test: productionGzipExtensions,
          minRatio: 0.99
        &#125;)
      );
    &#125;
    config.plugins = [...config.plugins, ...plugins];
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-开启-stylelint-检测scss-css语法"><a href="#✅-开启-stylelint-检测scss-css语法" class="headerlink" title="✅ 开启 stylelint 检测scss, css语法"></a><span id="stylelint">✅ 开启 stylelint 检测scss, css语法</span></h3><pre><code class="bash">npm i -D stylelint stylelint-config-standard stylelint-config-prettier stylelint-webpack-plugin
</code></pre>
<p>在文件夹创建stylelint.config.js,详细配置在<a target="_blank" rel="noopener" href="https://stylelint.io/user-guide/configuration">这里</a></p>
<pre><code class="javascript">module.exports = &#123;
  ignoreFiles: [&quot;**/*.js&quot;, &quot;src/assets/css/element-variables.scss&quot;, &quot;theme/&quot;], 
  extends: [&quot;stylelint-config-standard&quot;, &quot;stylelint-config-prettier&quot;],
  rules: &#123;
    &quot;no-empty-source&quot;: null,
    &quot;at-rule-no-unknown&quot;: [
      true,
      &#123;
        ignoreAtRules: [&quot;extend&quot;]
      &#125;
    ]
  &#125;
&#125;;
</code></pre>
<p>启用webpack配置</p>
<pre><code class="javascript">const StylelintPlugin = require(&quot;stylelint-webpack-plugin&quot;);

module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    const plugins = [];
    if (IS_DEV) &#123;
      plugins.push(
        new StylelintPlugin(&#123;
          files: [&quot;src/**/*.vue&quot;, &quot;src/assets/**/*.scss&quot;],
          fix: true //打开自动修复（谨慎使用！注意上面的配置不要加入js或html文件，会发生问题，js文件请手动修复）
        &#125;)
      );
    &#125;
    config.plugins = [...config.plugins, ...plugins];
  &#125;
&#125;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-为-sass-提供全局样式，以及全局变量"><a href="#✅-为-sass-提供全局样式，以及全局变量" class="headerlink" title="✅ 为 sass 提供全局样式，以及全局变量"></a><span id="globalscss">✅ 为 sass 提供全局样式，以及全局变量</span></h3><p>&emsp;&emsp;可以通过在 main.js 中 Vue.prototype.$src = process.env.VUE_APP_PUBLIC_PATH;挂载环境变量中的配置信息，然后在js中使用$src 访问。</p>
<p>&emsp;&emsp;css 中可以使用注入 sass 变量访问环境变量中的配置信息</p>
<pre><code class="javascript">const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

module.exports = &#123;
  css: &#123;
    extract: IS_PROD,
    sourceMap: false,
    loaderOptions: &#123;
      scss: &#123;
        // 向全局sass样式传入共享的全局变量, $src可以配置图片cdn前缀
        // 详情: https://cli.vuejs.org/guide/css.html#passing-options-to-pre-processor-loaders
        prependData: `
        @import &quot;@scss/variables.scss&quot;;
        @import &quot;@scss/mixins.scss&quot;;
        @import &quot;@scss/function.scss&quot;;
        $src: &quot;$&#123;process.env.VUE_APP_OSS_SRC&#125;&quot;;
        `
      &#125;
    &#125;
  &#125;
&#125;;
</code></pre>
<p>在 scss 中引用</p>
<pre><code class="css">.home &#123;
  background: url($src+&quot;/images/500.png&quot;);
&#125;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-为-stylus-提供全局变量"><a href="#✅-为-stylus-提供全局变量" class="headerlink" title="✅ 为 stylus 提供全局变量"></a><span id="globalstylus">✅ 为 stylus 提供全局变量</span></h3><pre><code class="bash">npm i -D style-resources-loader
</code></pre>
<pre><code class="javascript">const path = require(&quot;path&quot;);
const resolve = dir =&gt; path.resolve(__dirname, dir);
const addStylusResource = rule =&gt; &#123;
  rule
    .use(&quot;style-resouce&quot;)
    .loader(&quot;style-resources-loader&quot;)
    .options(&#123;
      patterns: [resolve(&quot;src/assets/stylus/variable.styl&quot;)]
    &#125;);
&#125;;
module.exports = &#123;
  chainWebpack: config =&gt; &#123;
    const types = [&quot;vue-modules&quot;, &quot;vue&quot;, &quot;normal-modules&quot;, &quot;normal&quot;];
    types.forEach(type =&gt;
      addStylusResource(config.module.rule(&quot;stylus&quot;).oneOf(type))
    );
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="预渲染-prerender-spa-plugin"><a href="#预渲染-prerender-spa-plugin" class="headerlink" title="预渲染 prerender-spa-plugin"></a><span id="prerender">预渲染 prerender-spa-plugin</span></h3><pre><code class="bash">npm i -D prerender-spa-plugin
</code></pre>
<pre><code class="javascript">const PrerenderSpaPlugin = require(&quot;prerender-spa-plugin&quot;);
const path = require(&quot;path&quot;);
const resolve = dir =&gt; path.join(__dirname, dir);
const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    const plugins = [];
    if (IS_PROD) &#123;
      plugins.push(
        new PrerenderSpaPlugin(&#123;
          staticDir: resolve(&quot;dist&quot;),
          routes: [&quot;/&quot;],
          postProcess(ctx) &#123;
            ctx.route = ctx.originalRoute;
            ctx.html = ctx.html.split(/&gt;[\s]+&lt;/gim).join(&quot;&gt;&lt;&quot;);
            if (ctx.route.endsWith(&quot;.html&quot;)) &#123;
              ctx.outputPath = path.join(__dirname, &quot;dist&quot;, ctx.route);
            &#125;
            return ctx;
          &#125;,
          minify: &#123;
            collapseBooleanAttributes: true,
            collapseWhitespace: true,
            decodeEntities: true,
            keepClosingSlash: true,
            sortAttributes: true
          &#125;,
          renderer: new PrerenderSpaPlugin.PuppeteerRenderer(&#123;
            // 需要注入一个值，这样就可以检测页面当前是否是预渲染的
            inject: &#123;&#125;,
            headless: false,
            // 视图组件是在API请求获取所有必要数据后呈现的，因此我们在dom中存在“data view”属性后创建页面快照
            renderAfterDocumentEvent: &quot;render-event&quot;
          &#125;)
        &#125;)
      );
    &#125;
    config.plugins = [...config.plugins, ...plugins];
  &#125;
&#125;;
</code></pre>
<p>&emsp;&emsp;mounted()中添加 document.dispatchEvent(new Event(‘render-event’))</p>
<pre><code class="javascript">new Vue(&#123;
  router,
  store,
  render: h =&gt; h(App),
  mounted() &#123;
    document.dispatchEvent(new Event(&quot;render-event&quot;));
  &#125;
&#125;).$mount(&quot;#app&quot;);
</code></pre>
<h5 id="为自定义预渲染页面添加自定义-title、description、content"><a href="#为自定义预渲染页面添加自定义-title、description、content" class="headerlink" title="为自定义预渲染页面添加自定义 title、description、content"></a>为自定义预渲染页面添加自定义 title、description、content</h5><ul>
<li><p>删除 public/index.html 中关于 description、content 的 meta 标签。保留 title 标签</p>
</li>
<li><p>配置 router-config.js</p>
</li>
</ul>
<pre><code class="javascript">module.exports = &#123;
  &quot;/&quot;: &#123;
    title: &quot;首页&quot;,
    keywords: &quot;首页关键词&quot;,
    description: &quot;这是首页描述&quot;
  &#125;,
  &quot;/about.html&quot;: &#123;
    title: &quot;关于我们&quot;,
    keywords: &quot;关于我们页面关键词&quot;,
    description: &quot;关于我们页面关键词描述&quot;
  &#125;
&#125;;
</code></pre>
<ul>
<li>vue.config.js</li>
</ul>
<pre><code class="js">const path = require(&quot;path&quot;);
const PrerenderSpaPlugin = require(&quot;prerender-spa-plugin&quot;);
const routesConfig = require(&quot;./router-config&quot;);
const resolve = dir =&gt; path.join(__dirname, dir);
const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

module.exports = &#123;
  configureWebpack: config =&gt; &#123;
    const plugins = [];

    if (IS_PROD) &#123;
      // 预加载
      plugins.push(
        new PrerenderSpaPlugin(&#123;
          staticDir: resolve(&quot;dist&quot;),
          routes: Object.keys(routesConfig),
          postProcess(ctx) &#123;
            ctx.route = ctx.originalRoute;
            ctx.html = ctx.html.split(/&gt;[\s]+&lt;/gim).join(&quot;&gt;&lt;&quot;);
            ctx.html = ctx.html.replace(
              /&lt;title&gt;(.*?)&lt;\/title&gt;/gi,
              `&lt;title&gt;$&#123;
                routesConfig[ctx.route].title
              &#125;&lt;/title&gt;&lt;meta name=&quot;keywords&quot; content=&quot;$&#123;
                routesConfig[ctx.route].keywords
              &#125;&quot; /&gt;&lt;meta name=&quot;description&quot; content=&quot;$&#123;
                routesConfig[ctx.route].description
              &#125;&quot; /&gt;`
            );
            if (ctx.route.endsWith(&quot;.html&quot;)) &#123;
              ctx.outputPath = path.join(__dirname, &quot;dist&quot;, ctx.route);
            &#125;
            return ctx;
          &#125;,
          minify: &#123;
            collapseBooleanAttributes: true,
            collapseWhitespace: true,
            decodeEntities: true,
            keepClosingSlash: true,
            sortAttributes: true
          &#125;,
          renderer: new PrerenderSpaPlugin.PuppeteerRenderer(&#123;
            // 需要注入一个值，这样就可以检测页面当前是否是预渲染的
            inject: &#123;&#125;,
            headless: false,
            // 视图组件是在API请求获取所有必要数据后呈现的，因此我们在dom中存在“data view”属性后创建页面快照
            renderAfterDocumentEvent: &quot;render-event&quot;
          &#125;)
        &#125;)
      );
    &#125;

    config.plugins = [...config.plugins, ...plugins];
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-添加-IE-兼容"><a href="#✅-添加-IE-兼容" class="headerlink" title="✅ 添加 IE 兼容"></a><span id="ie">✅ 添加 IE 兼容</span></h3><p>&emsp;&emsp;在 main.js 中添加</p>
<pre><code class="javascript">import &#39;core-js/stable&#39;; 
import &#39;regenerator-runtime/runtime&#39;;
</code></pre>
<p>配置 babel.config.js</p>
<pre><code class="javascript">const plugins = [];

module.exports = &#123;
  presets: [[&quot;@vue/app&quot;, &#123; useBuiltIns: &quot;entry&quot; &#125;]],
  plugins: plugins
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-静态资源自动打包上传阿里-oss、华为-obs"><a href="#✅-静态资源自动打包上传阿里-oss、华为-obs" class="headerlink" title="✅ 静态资源自动打包上传阿里 oss、华为 obs"></a><span id="alioss">✅ 静态资源自动打包上传阿里 oss、华为 obs</span></h3><p>&emsp;&emsp;开启文件上传 ali oss，需要将 publicPath 改成 ali oss 资源 url 前缀,也就是修改 VUE_APP_PUBLIC_PATH。具体配置参见<a target="_blank" rel="noopener" href="https://github.com/staven630/webpack-oss">阿里 oss 插件 webpack-oss</a>、<a target="_blank" rel="noopener" href="https://github.com/staven630/huawei-obs-plugin">华为 obs 插件 huawei-obs-plugin</a></p>
<pre><code class="bash">npm i -D webpack-oss
</code></pre>
<pre><code class="javascript">const AliOssPlugin = require(&quot;webpack-oss&quot;);
const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

const format = AliOssPlugin.getFormat();

module.exports = &#123;
  publicPath: IS_PROD ? `$&#123;process.env.VUE_APP_PUBLIC_PATH&#125;/$&#123;format&#125;` : &quot;./&quot;, // 默认&#39;/&#39;，部署应用包时的基本 URL
  configureWebpack: config =&gt; &#123;
    const plugins = [];

    if (IS_PROD) &#123;
      plugins.push(
        new AliOssPlugin(&#123;
          accessKeyId: process.env.ACCESS_KEY_ID,
          accessKeySecret: process.env.ACCESS_KEY_SECRET,
          region: process.env.REGION,
          bucket: process.env.BUCKET,
          prefix: process.env.PREFIX,
          exclude: /.*\.html$/,
          format
        &#125;)
      );
    &#125;
    config.plugins = [...config.plugins, ...plugins];
  &#125;
&#125;;
</code></pre>
<p><a href="#top">▲ 回顶部</a></p>
<h3 id="✅-完整配置"><a href="#✅-完整配置" class="headerlink" title="✅ 完整配置"></a><span id="allconfig">✅ 完整配置</span></h3><pre><code class="javascript">const SpritesmithPlugin = require(&quot;webpack-spritesmith&quot;);
const BundleAnalyzerPlugin = require(&quot;webpack-bundle-analyzer&quot;)
  .BundleAnalyzerPlugin;
const webpack = require(&quot;webpack&quot;);

const path = require(&quot;path&quot;);
const fs = require(&quot;fs&quot;);
const resolve = dir =&gt; path.join(__dirname, dir);
const IS_PROD = [&quot;production&quot;, &quot;prod&quot;].includes(process.env.NODE_ENV);

const glob = require(&#39;glob&#39;)
const pagesInfo = require(&#39;./pages.config&#39;)
const pages = &#123;&#125;

glob.sync(&#39;./src/pages/**/main.js&#39;).forEach(entry =&gt; &#123;
  let chunk = entry.match(/\.\/src\/pages\/(.*)\/main\.js/)[1];
  const curr = pagesInfo[chunk];
  if (curr) &#123;
    pages[chunk] = &#123;
      entry,
      ...curr,
      chunk: [&quot;chunk-vendors&quot;, &quot;chunk-common&quot;, chunk]
    &#125;
  &#125;
&#125;)

let has_sprite = true;
let files = [];
const icons = &#123;&#125;;

try &#123;
  fs.statSync(resolve(&quot;./src/assets/icons&quot;));
  files = fs.readdirSync(resolve(&quot;./src/assets/icons&quot;));
  files.forEach(item =&gt; &#123;
    let filename = item.toLocaleLowerCase().replace(/_/g, &quot;-&quot;);
    icons[filename] = true;
  &#125;);

&#125; catch (error) &#123;
  fs.mkdirSync(resolve(&quot;./src/assets/icons&quot;));
&#125;

if (!files.length) &#123;
  has_sprite = false;
&#125; else &#123;
  try &#123;
    let iconsObj = fs.readFileSync(resolve(&quot;./icons.json&quot;), &quot;utf8&quot;);
    iconsObj = JSON.parse(iconsObj);
    has_sprite = files.some(item =&gt; &#123;
      let filename = item.toLocaleLowerCase().replace(/_/g, &quot;-&quot;);
      return !iconsObj[filename];
    &#125;);
    if (has_sprite) &#123;
      fs.writeFileSync(resolve(&quot;./icons.json&quot;), JSON.stringify(icons, null, 2));
    &#125;
  &#125; catch (error) &#123;
    fs.writeFileSync(resolve(&quot;./icons.json&quot;), JSON.stringify(icons, null, 2));
    has_sprite = true;
  &#125;
&#125;

// 雪碧图样式处理模板
const SpritesmithTemplate = function (data) &#123;
  // pc
  let icons = &#123;&#125;
  let tpl = `.ico &#123; 
  display: inline-block; 
  background-image: url($&#123;data.sprites[0].image&#125;); 
  background-size: $&#123;data.spritesheet.width&#125;px $&#123;data.spritesheet.height&#125;px; 
&#125;`

  data.sprites.forEach(sprite =&gt; &#123;
    const name = &#39;&#39; + sprite.name.toLocaleLowerCase().replace(/_/g, &#39;-&#39;)
    icons[`$&#123;name&#125;.png`] = true
    tpl = `$&#123;tpl&#125; 
.ico-$&#123;name&#125;&#123;
  width: $&#123;sprite.width&#125;px; 
  height: $&#123;sprite.height&#125;px; 
  background-position: $&#123;sprite.offset_x&#125;px $&#123;sprite.offset_y&#125;px;
&#125;
`
  &#125;)
  return tpl
&#125;

module.exports = &#123;
  publicPath: IS_PROD ? process.env.VUE_APP_PUBLIC_PATH : &quot;./&quot;, // 默认&#39;/&#39;，部署应用包时的基本 URL
  // outputDir: process.env.outputDir || &#39;dist&#39;, // &#39;dist&#39;, 生产环境构建文件的目录
  // assetsDir: &quot;&quot;, // 相对于outputDir的静态资源(js、css、img、fonts)目录
  configureWebpack: config =&gt; &#123;
    const plugins = [];

    if (has_sprite) &#123;
      // 生成雪碧图
      plugins.push(
        new SpritesmithPlugin(&#123;
          src: &#123;
            cwd: path.resolve(__dirname, &#39;./src/assets/icons/&#39;), // 图标根路径
            glob: &#39;**/*.png&#39; // 匹配任意 png 图标
          &#125;,
          target: &#123;
            image: path.resolve(__dirname, &#39;./src/assets/images/sprites.png&#39;), // 生成雪碧图目标路径与名称
            // 设置生成CSS背景及其定位的文件或方式
            css: [
              [
                path.resolve(__dirname, &#39;./src/assets/scss/sprites.scss&#39;),
                &#123;
                  format: &#39;function_based_template&#39;
                &#125;
              ]
            ]
          &#125;,
          customTemplates: &#123;
            function_based_template: SpritesmithTemplate
          &#125;,
          apiOptions: &#123;
            cssImageRef: &#39;../images/sprites.png&#39; // css文件中引用雪碧图的相对位置路径配置
          &#125;,
          spritesmithOptions: &#123;
            padding: 2
          &#125;
        &#125;)
      )
    &#125;

    config.externals = &#123;
      vue: &quot;Vue&quot;,
      &quot;element-ui&quot;: &quot;ELEMENT&quot;,
      &quot;vue-router&quot;: &quot;VueRouter&quot;,
      vuex: &quot;Vuex&quot;,
      axios: &quot;axios&quot;
    &#125;;

    config.plugins = [...config.plugins, ...plugins];
  &#125;,
  chainWebpack: config =&gt; &#123;
    // 修复HMR
    config.resolve.symlinks(true);

    // config.plugins.delete(&#39;preload&#39;);
    // config.plugins.delete(&#39;prefetch&#39;);

    config
      .plugin(&quot;ignore&quot;)
      .use(
        new webpack.ContextReplacementPlugin(/moment[/\\]locale$/, /zh-cn$/)
      );

    // 添加别名
    config.resolve.alias
      .set(&quot;vue$&quot;, &quot;vue/dist/vue.esm.js&quot;)
      .set(&quot;@&quot;, resolve(&quot;src&quot;))
      .set(&quot;@apis&quot;, resolve(&quot;src/apis&quot;))
      .set(&quot;@assets&quot;, resolve(&quot;src/assets&quot;))
      .set(&quot;@scss&quot;, resolve(&quot;src/assets/scss&quot;))
      .set(&quot;@components&quot;, resolve(&quot;src/components&quot;))
      .set(&quot;@middlewares&quot;, resolve(&quot;src/middlewares&quot;))
      .set(&quot;@mixins&quot;, resolve(&quot;src/mixins&quot;))
      .set(&quot;@plugins&quot;, resolve(&quot;src/plugins&quot;))
      .set(&quot;@router&quot;, resolve(&quot;src/router&quot;))
      .set(&quot;@store&quot;, resolve(&quot;src/store&quot;))
      .set(&quot;@utils&quot;, resolve(&quot;src/utils&quot;))
      .set(&quot;@views&quot;, resolve(&quot;src/views&quot;))
      .set(&quot;@layouts&quot;, resolve(&quot;src/layouts&quot;));

    const cdn = &#123;
      // 访问https://unpkg.com/element-ui/lib/theme-chalk/index.css获取最新版本
      css: [&quot;//unpkg.com/element-ui@2.10.1/lib/theme-chalk/index.css&quot;],
      js: [
        &quot;//unpkg.com/vue@2.6.10/dist/vue.min.js&quot;, // 访问https://unpkg.com/vue/dist/vue.min.js获取最新版本
        &quot;//unpkg.com/vue-router@3.0.6/dist/vue-router.min.js&quot;,
        &quot;//unpkg.com/vuex@3.1.1/dist/vuex.min.js&quot;,
        &quot;//unpkg.com/axios@0.19.0/dist/axios.min.js&quot;,
        &quot;//unpkg.com/element-ui@2.10.1/lib/index.js&quot;
      ]
    &#125;;

    // 如果使用多页面打包，使用vue inspect --plugins查看html是否在结果数组中
    // config.plugin(&quot;html&quot;).tap(args =&gt; &#123;
    //   // html中添加cdn
    //   args[0].cdn = cdn;

    //   // 修复 Lazy loading routes Error
    //   args[0].chunksSortMode = &quot;none&quot;;
    //   return args;
    // &#125;);

    // 防止多页面打包卡顿
    config =&gt; config.plugins.delete(&#39;named-chunks&#39;)

    // 多页面cdn添加
    Object.keys(pagesInfo).forEach(page =&gt; &#123;
      config.plugin(`html-$&#123;page&#125;`).tap(args =&gt; &#123;
        // html中添加cdn
        args[0].cdn = cdn;

        // 修复 Lazy loading routes Error
        args[0].chunksSortMode = &quot;none&quot;;
        return args;
      &#125;);
    &#125;)

    if (IS_PROD) &#123;
      // 压缩图片
      config.module
        .rule(&quot;images&quot;)
        .test(/\.(png|jpe?g|gif|svg)(\?.*)?$/)
        .use(&quot;image-webpack-loader&quot;)
        .loader(&quot;image-webpack-loader&quot;)
        .options(&#123;
          mozjpeg: &#123; progressive: true, quality: 65 &#125;,
          optipng: &#123; enabled: false &#125;,
          pngquant: &#123; quality: [0.65, 0.90], speed: 4 &#125;,
          gifsicle: &#123; interlaced: false &#125;
        &#125;);

      // 打包分析
      config.plugin(&quot;webpack-report&quot;).use(BundleAnalyzerPlugin, [
        &#123;
          analyzerMode: &quot;static&quot;
        &#125;
      ]);
    &#125;

    // 使用svg组件
    const svgRule = config.module.rule(&quot;svg&quot;);
    svgRule.uses.clear();
    svgRule.exclude.add(/node_modules/);
    svgRule
      .test(/\.svg$/)
      .use(&quot;svg-sprite-loader&quot;)
      .loader(&quot;svg-sprite-loader&quot;)
      .options(&#123;
        symbolId: &quot;icon-[name]&quot;
      &#125;);

    const imagesRule = config.module.rule(&quot;images&quot;);
    imagesRule.exclude.add(resolve(&quot;src/icons&quot;));
    config.module.rule(&quot;images&quot;).test(/\.(png|jpe?g|gif|svg)(\?.*)?$/);

    return config;
  &#125;,
  pages,
  css: &#123;
    extract: IS_PROD,
    sourceMap: false,
    loaderOptions: &#123;
      scss: &#123;
        // 向全局sass样式传入共享的全局变量, $src可以配置图片cdn前缀
        // 详情: https://cli.vuejs.org/guide/css.html#passing-options-to-pre-processor-loaders
        prependData: `
          @import &quot;@scss/variables.scss&quot;;
          @import &quot;@scss/mixins.scss&quot;;
          @import &quot;@scss/function.scss&quot;;
          $src: &quot;$&#123;process.env.VUE_APP_BASE_API&#125;&quot;;
          `
      &#125;
    &#125;
  &#125;,
  lintOnSave: false,
  runtimeCompiler: true, // 是否使用包含运行时编译器的 Vue 构建版本
  productionSourceMap: !IS_PROD, // 生产环境的 source map
  parallel: require(&quot;os&quot;).cpus().length &gt; 1,
  pwa: &#123;&#125;,
  devServer: &#123;
    // overlay: &#123; // 让浏览器 overlay 同时显示警告和错误
    //   warnings: true,
    //   errors: true
    // &#125;,
    // open: false, // 是否打开浏览器
    // host: &quot;localhost&quot;,
    // port: &quot;8080&quot;, // 代理断就
    // https: false,
    // hotOnly: false, // 热更新
    proxy: &#123;
      &quot;/api&quot;: &#123;
        target:
          &quot;https://www.easy-mock.com/mock/5bc75b55dc36971c160cad1b/sheets&quot;, // 目标代理接口地址
        secure: false,
        changeOrigin: true, // 开启代理，在本地创建一个虚拟服务端
        // ws: true, // 是否启用websockets
        pathRewrite: &#123;
          &quot;^/api&quot;: &quot;/&quot;
        &#125;
      &#125;
    &#125;
  &#125;
&#125;;
</code></pre>
<hr>
<p>文章来源:<a target="_blank" rel="noopener" href="https://github.com/staven630/vue-cli4-config">github文章:vue-cli4 全面配置</a></p>

        </article>

        
            
  <div class="nexmoe-post-copyright">
    <strong>本文作者：</strong>staven630<br>
    
      <strong>文章来源：</strong><a href="https://github.com/staven630/vue-cli4-config" title="https:&#x2F;&#x2F;github.com&#x2F;staven630&#x2F;vue-cli4-config" target="_blank" rel="noopener">https:&#x2F;&#x2F;github.com&#x2F;staven630&#x2F;vue-cli4-config</a><br>
    
    <strong>本文链接：</strong><a href="https://www.tangyuxian.com/2021/04/13/%E5%89%8D%E7%AB%AF/webpack/webpack-vueCli4%20%E5%85%A8%E9%9D%A2%E9%85%8D%E7%BD%AE/" title="https:&#x2F;&#x2F;www.tangyuxian.com&#x2F;2021&#x2F;04&#x2F;13&#x2F;%E5%89%8D%E7%AB%AF&#x2F;webpack&#x2F;webpack-vueCli4%20%E5%85%A8%E9%9D%A2%E9%85%8D%E7%BD%AE&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;www.tangyuxian.com&#x2F;2021&#x2F;04&#x2F;13&#x2F;%E5%89%8D%E7%AB%AF&#x2F;webpack&#x2F;webpack-vueCli4%20%E5%85%A8%E9%9D%A2%E9%85%8D%E7%BD%AE&#x2F;</a><br>

    
      <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可
    
  </div>


        

        <div class="nexmoe-post-meta nexmoe-rainbow">
    
        <a class="nexmoefont icon-appstore-fill -link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
    
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/vue/" rel="tag">vue</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/webpack/" rel="tag">webpack</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag">转载</a>
    
</div>

    <div class="nexmoe-post-footer">
        <section class="nexmoe-comment">
    <div class="valine"></div>
<script src='https://cdn.jsdelivr.net/npm/valine@1.3.9/dist/Valine.min.js'></script>
<script>
    // 使用方法 https://valine.js.org/quickstart.html
    new Valine({
        el: '.valine',
        appId: 'r5zxC0st0DDjPA9auXzMV7HY-gzGzoHsz',
        appKey: '3bqCsovpyfTPHUzTHovd3V3V'
    })
</script>
</section>
    </div>
</div>


        <div class="nexmoe-post-right">
          
            <div class="nexmoe-fixed">
              <div class="nexmoe-tool">
                <a href="#" aria-label="回到顶部" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
              </div>
            </div>
          
        </div>
    </div>
  </div>
  <div id="nexmoe-pendant">
    <div class="nexmoe-drawer mdui-drawer nexmoe-pd" id="drawer">
        
            <div class="nexmoe-pd-item">
                <div class="clock">
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="memory"></div>
        <div class="needle" id="hours"></div>
        <div class="needle" id="minutes"></div>
        <div class="needle" id="seconds"></div>
        <div class="clock_logo">

        </div>

    </div>
<style>
    .clock {
        background-color: #ffffff;
        width: 70vw;
        height: 70vw;
        max-width: 70vh;
        max-height: 70vh;
        border: solid 2.8vw #242424;
        position: relative;
        overflow: hidden;
        border-radius: 50%;
        box-sizing: border-box;
        box-shadow: 0 1.4vw 2.8vw rgba(0, 0, 0, 0.8);
        zoom:0.2
    }

    .memory {
        position: absolute;
        top: 50%;
        left: 50%;
        transform-origin: center;
    }

    .memory:nth-child(1) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(0deg) translateY(-520%);
    }

    .memory:nth-child(2) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(6deg) translateY(-1461%);
    }

    .memory:nth-child(3) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(12deg) translateY(-1461%);
    }

    .memory:nth-child(4) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(18deg) translateY(-1461%);
    }

    .memory:nth-child(5) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(24deg) translateY(-1461%);
    }

    .memory:nth-child(6) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(30deg) translateY(-520%);
    }

    .memory:nth-child(7) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(36deg) translateY(-1461%);
    }

    .memory:nth-child(8) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(42deg) translateY(-1461%);
    }

    .memory:nth-child(9) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(48deg) translateY(-1461%);
    }

    .memory:nth-child(10) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(54deg) translateY(-1461%);
    }

    .memory:nth-child(11) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(60deg) translateY(-520%);
    }

    .memory:nth-child(12) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(66deg) translateY(-1461%);
    }

    .memory:nth-child(13) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(72deg) translateY(-1461%);
    }

    .memory:nth-child(14) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(78deg) translateY(-1461%);
    }

    .memory:nth-child(15) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(84deg) translateY(-1461%);
    }

    .memory:nth-child(16) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(90deg) translateY(-520%);
    }

    .memory:nth-child(17) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(96deg) translateY(-1461%);
    }

    .memory:nth-child(18) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(102deg) translateY(-1461%);
    }

    .memory:nth-child(19) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(108deg) translateY(-1461%);
    }

    .memory:nth-child(20) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(114deg) translateY(-1461%);
    }

    .memory:nth-child(21) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(120deg) translateY(-520%);
    }

    .memory:nth-child(22) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(126deg) translateY(-1461%);
    }

    .memory:nth-child(23) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(132deg) translateY(-1461%);
    }

    .memory:nth-child(24) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(138deg) translateY(-1461%);
    }

    .memory:nth-child(25) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(144deg) translateY(-1461%);
    }

    .memory:nth-child(26) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(150deg) translateY(-520%);
    }

    .memory:nth-child(27) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(156deg) translateY(-1461%);
    }

    .memory:nth-child(28) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(162deg) translateY(-1461%);
    }

    .memory:nth-child(29) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(168deg) translateY(-1461%);
    }

    .memory:nth-child(30) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(174deg) translateY(-1461%);
    }

    .memory:nth-child(31) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(180deg) translateY(-520%);
    }

    .memory:nth-child(32) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(186deg) translateY(-1461%);
    }

    .memory:nth-child(33) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(192deg) translateY(-1461%);
    }

    .memory:nth-child(34) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(198deg) translateY(-1461%);
    }

    .memory:nth-child(35) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(204deg) translateY(-1461%);
    }

    .memory:nth-child(36) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(210deg) translateY(-520%);
    }

    .memory:nth-child(37) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(216deg) translateY(-1461%);
    }

    .memory:nth-child(38) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(222deg) translateY(-1461%);
    }

    .memory:nth-child(39) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(228deg) translateY(-1461%);
    }

    .memory:nth-child(40) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(234deg) translateY(-1461%);
    }

    .memory:nth-child(41) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(240deg) translateY(-520%);
    }

    .memory:nth-child(42) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(246deg) translateY(-1461%);
    }

    .memory:nth-child(43) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(252deg) translateY(-1461%);
    }

    .memory:nth-child(44) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(258deg) translateY(-1461%);
    }

    .memory:nth-child(45) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(264deg) translateY(-1461%);
    }

    .memory:nth-child(46) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(270deg) translateY(-520%);
    }

    .memory:nth-child(47) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(276deg) translateY(-1461%);
    }

    .memory:nth-child(48) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(282deg) translateY(-1461%);
    }

    .memory:nth-child(49) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(288deg) translateY(-1461%);
    }

    .memory:nth-child(50) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(294deg) translateY(-1461%);
    }

    .memory:nth-child(51) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(300deg) translateY(-520%);
    }

    .memory:nth-child(52) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(306deg) translateY(-1461%);
    }

    .memory:nth-child(53) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(312deg) translateY(-1461%);
    }

    .memory:nth-child(54) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(318deg) translateY(-1461%);
    }

    .memory:nth-child(55) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(324deg) translateY(-1461%);
    }

    .memory:nth-child(56) {
        background-color: #424242;
        width: 2%;
        height: 8%;
        transform: translate(-50%, -50%) rotate(330deg) translateY(-520%);
    }

    .memory:nth-child(57) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(336deg) translateY(-1461%);
    }

    .memory:nth-child(58) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(342deg) translateY(-1461%);
    }

    .memory:nth-child(59) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(348deg) translateY(-1461%);
    }

    .memory:nth-child(60) {
        background-color: #949494;
        width: 1%;
        height: 3%;
        transform: translate(-50%, -50%) rotate(354deg) translateY(-1461%);
    }

    .needle {
        position: absolute;
        top: 50%;
        left: 50%;
        transform-origin: center;
    }

    .needle#hours {
        background-color: #1f1f1f;
        width: 4%;
        height: 30%;
        transform-origin: center 75%;
        transform: translate(-50%, -75%);
    }

    .needle#hours.moving {
        transition: transform 150ms ease-out;
    }

    .needle#hours:after {
        content: '';
        background-color: #1f1f1f;
        width: 4vw;
        height: 4vw;
        max-width: 4vh;
        max-height: 4vh;
        display: block;
        position: absolute;
        top: 75%;
        left: 50%;
        box-sizing: border-box;
        border-radius: 50%;
        transform: translate(-50%, -50%);
    }

    .needle#minutes {
        background-color: #1f1f1f;
        width: 2%;
        height: 45%;
        transform-origin: center 75%;
        transform: translate(-50%, -75%);
    }

    .needle#minutes.moving {
        transition: transform 150ms ease-out;
    }

    .needle#minutes:after {
        content: '';
        background-color: #1f1f1f;
        width: 4vw;
        height: 4vw;
        max-width: 4vh;
        max-height: 4vh;
        display: block;
        position: absolute;
        top: 75%;
        left: 50%;
        box-sizing: border-box;
        border-radius: 50%;
        transform: translate(-50%, -50%);
    }

    .needle#seconds {
        background-color: #cb2f2f;
        width: 1%;
        height: 50%;
        transform-origin: center 75%;
        transform: translate(-50%, -75%);
    }

    .needle#seconds.moving {
        transition: transform 150ms ease-out;
    }

    .needle#seconds:after {
        content: '';
        background-color: #cb2f2f;
        width: 2.5vw;
        height: 2.5vw;
        max-width: 2.5vh;
        max-height: 2.5vh;
        display: block;
        position: absolute;
        top: 75%;
        left: 50%;
        box-sizing: border-box;
        border-radius: 50%;
        transform: translate(-50%, -50%);
    }
    .clock_logo{
        width: 10vw;
        height: 10vw;
        max-width: 10vh;
        max-height: 10vh;
        position: absolute;
        top: 50%;
        left: 50%;
        box-sizing: border-box;
        border-radius: 50%;
        transform: translate(-50%, -50%);
        background-size: 100% 100%;
        background-repeat: no-repeat;
    }
    @media (min-width: 100vh) {
        .clock {
            border: solid 2.8vh #242424;
            box-shadow: 0 1.4vh 2.8vh rgba(0, 0, 0, 0.8);
        }
    }

</style>





            </div>
        
            <div class="nexmoe-pd-item">
                <div class="qweather" >
    <div id="he-plugin-standard"></div>
    <div class="qweather-logo">

    </div>

</div>
<style>
    .qweather{
        position: relative;
    }
    .qweather-logo{
        position: absolute;
        right: 0;
        top: -15px;
        width: 40px;
        height: 40px;
        background-size: 100% 100%;
        background-repeat: no-repeat;
    }
</style>
<script>
  WIDGET = {
    "CONFIG": {
      "layout": "2",
      "width": "260",
      "height": "220",
      "background": "5",
      "dataColor": "e67249",
      "borderRadius": "15",
      "key": "f74d1e1690e6432d801e97fa2f05a162"
    }
  }
</script>
<script src="https://widget.qweather.net/standard/static/js/he-standard-common.js?v=2.0"></script>

            </div>
        
</div>
<style>
    .nexmoe-pd {
        left: auto;
        top: 40px;
        right: 0;
    }
    .nexmoe-pd-item{
       display: flex;
        justify-content: center;
        margin-bottom: 30px;
    }
</style>

  </div>
  <script src="https://cdn.jsdelivr.net/combine/npm/lazysizes@5.1.0/lazysizes.min.js,gh/highlightjs/cdn-release@9.15.8/build/highlight.min.js,npm/mdui@0.4.3/dist/js/mdui.min.js?v=1"></script>
<script>
	hljs.initHighlightingOnLoad();
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>


<script src="/js/app.js?v=1632320198521"></script>

<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"></script>
<script>
	$(".justified-gallery").justifiedGallery({
		rowHeight: 160,
		margins: 10,
	});
</script>

  





<!-- hexo injector body_end start -->
<script src="/js/clock.js"></script>

<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.8/dist/clipboard.min.js"></script>

<script src="/lib/codeBlock/codeBlockFuction.js"></script>

<script src="/lib/codeBlock/codeLang.js"></script>

<script src="/lib/codeBlock/codeCopy.js"></script>

<script src="/lib/codeBlock/codeShrink.js"></script>

<link rel="stylesheet" href="/lib/codeBlock/matery.css">

<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js"></script>

<script src="/js/search.js"></script>

<script src="/js/webapp.js"></script>
<!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/xiaomai.model.json"},"display":{"position":"left","width":200,"height":500},"mobile":{"show":false},"react":{"opacity":0.9},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>

<script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/250cb4aa.js","daovoice")</script>
<script>
  daovoice('init', {
    app_id: "250cb4aa"
  });
  daovoice('update');
</script>

